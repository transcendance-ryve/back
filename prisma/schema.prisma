// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
	provider = "prisma-client-js"
}

datasource db {
	provider = "postgresql"
	url      = env("DATABASE_URL")
}

model User {
	id				String			@id @default(cuid())
	username		String			@unique
	email			String			@unique
	password		String
	auth			Boolean			@default(false)
	
	avatar			String			@default("http://localhost:3000/default.png")

	status          Status          @default(OFFLINE)

	level			Int			    @default(0)
	experience		Int			    @default(0)
	next_level		Int			    @default(100)
	rank_point      Int             @default(0)
    wins            Int             @default(0)
    loses           Int             @default(0)
    played          Int             @default(0)

	tfa_token		String?
	tfa_secret		String?
	tfa_enabled		Boolean			@default(false)

	friends			Friendship[]	@relation("friends")
	friends_request	Friendship[]	@relation("friendsRequests")

	@@map("users")
}

model Friendship {
	id              String          @id @default(cuid())
	sender          User           	@relation("friends", fields: [sender_id], references: [id], onDelete: Cascade)
	sender_id        String
	receiver        User            @relation("friendsRequests", fields: [receiver_id], references: [id], onDelete: Cascade)
	receiver_id      String  
	accepted        Boolean         @default(false)

	@@unique([sender_id, receiver_id])
	@@map("friendships")
}

enum Status {
	OFFLINE @map("offline")
	ONLINE  @map("online")
	INGAME  @map("ingame")

	@@map("_status")
}